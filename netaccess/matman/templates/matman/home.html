{% extends "base.html" %}
{% load static %}
{% load matman_tags %}

{% block title %}My Materials{% endblock %}
{% block scripts %}
<script type="text/javascript" src="{% static "js/tables.js" %}" defer></script>
{% endblock %}

{% block content %}
<h1>My Materials</h1>
<div class="accordion" id="id_item_accordion">
    {% for name, rubric in rubrics.items %}
    <div class="accordion-item">
        <h2 class="accordion-header" id="id_accordion_header_{{ name }}">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#id_collapse_{{ name }}" aria-expanded="true" aria-controls="collapse_{{ name }}">
                {{ rubric.title }} ({{ rubric.total }})
            </button>
        </h2>
        <div id="id_collapse_{{ name }}" class="accordion-collapse collapse {% if rubric.is_open %}show{% endif %}" aria-labelledby="collapse_{{ name }}" data-bs-parent="#id_item_accordion">
            <div class="accordion-body">
                <table class="table table-striped table-hover sortable-table" id="material_table_{{ name }}">
                    <tr>
                        <th class="column-header-id">ID</th>
                        <th class="column-header-owner">Owner</th>
                        <th>Serial Number</th>
                        <th>Material Number</th>
                        <th>Manufacturer</th>
                        <th>Department</th>
                        <th>Location</th>
                        <th>Tags</th>
                    </tr>
                    {% for object in rubric.page %}
                    <tr>
                        <th><a href="{% url "material-detail" object.identifier %}">{{ object.identifier }}</a></th>
                        <td><a href="{% url "profile" object.owner %}">{{ object.owner }}</a></td>
                        <td>{{ object.serial_number }}</td>
                        <td>{{ object.material_number }}</td>
                        <td>{{ object.manufacturer }}</td>
                        <td>{{ object.department }}</td>
                        <td>{{ object.location }}</td>
                        <td>{{ object.tags.all|join:", " }}</td>
                    </tr>
                    {% empty %}
                    <tr><td>None</td></tr>
                    {% endfor %}
                </table>
                {% include "pagination.html" with page_obj=rubric.page page_param=name|add:"_page" %}
            </div>
        </div>
    </div>
    {% endfor %}

</div>
{% endblock %}


